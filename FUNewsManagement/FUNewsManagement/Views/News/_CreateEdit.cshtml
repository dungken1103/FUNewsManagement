@model DataAccessLayer.Models.NewsArticle
@{
    var formAction = ViewData["FormAction"] as string ?? "Create";
}
<form asp-action="" method="post" id="newsForm">
    @Html.AntiForgeryToken()
    @if (!string.IsNullOrEmpty(Model?.NewsArticleId))
    {
        <input asp-for="NewsArticleId" type="hidden" />
    }
    <div class="mb-3">
        <label class="form-label">Title</label>
        <input asp-for="NewsTitle" class="form-control" />
        <span asp-validation-for="NewsTitle" class="text-danger"></span>
    </div>
    <div class="mb-3">
        <label class="form-label">Headline</label>
        <input asp-for="Headline" class="form-control" />
        <span asp-validation-for="Headline" class="text-danger"></span>
    </div>
    <div class="mb-3">
        <label class="form-label">Category</label>
        <select asp-for="CategoryId" class="form-select">
            <option value="">-- Select --</option>
            @foreach(var c in (IEnumerable<DataAccessLayer.Models.Category>)ViewBag.Categories)
            {
                if(Model?.CategoryId == c.CategoryId)
                {
                    <option value="@c.CategoryId" selected="selected">@c.CategoryName</option>
                }
                else
                {
                    <option value="@c.CategoryId">@c.CategoryName</option>
                }
            }
        </select>
    </div>
    <div class="mb-3">
        <label class="form-label">Tags</label>
        <div>
            @foreach (var t in (IEnumerable<DataAccessLayer.Models.Tag>)ViewBag.Tags)
            {
                var isChecked = Model?.Tags != null && Model.Tags.Any(mt => mt.TagId == t.TagId);
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" name="selectedTags" value="@t.TagId" id="tag_@t.TagId" @(isChecked ? "checked" : "") />
                    <label class="form-check-label" for="tag_@t.TagId">@t.TagName</label>
                </div>
            }
        </div>
    </div>
    <div class="mb-3">
        <label class="form-label">Content</label>
        <textarea asp-for="NewsContent" class="form-control" rows="6"></textarea>
    </div>
    <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
    </div>
    <input type="hidden" id="_formAction" value="@formAction" />
</form>
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
